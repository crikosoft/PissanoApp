@model PissanoApp.ViewModels.RequerimientoViewModel

@{
    ViewBag.Title = "Edit";
}

<h2>Modificar Requerimiento</h2>

@using (Html.BeginForm())
{
    @Html.AntiForgeryToken()

    @Html.HiddenFor(model => model.TipoCompra.tipoCompraId)

    @Html.HiddenFor(model =>  Model.Requerimientos[0].requerimientoId)



    <div class="row wrapper border-bottom white-bg page-heading">
        <div class="col-lg-10">
            @*<h2>Requerimiento de Compra</h2>*@
            <ol class="breadcrumb">
                <li>
                    @Html.ActionLink("Lista", "Index")
                </li>
                <li class="active">
                    <strong>Edición de Requerimiento</strong>
                </li>
            </ol>
        </div>
        @*<div class="col-lg-2">

            </div>*@
    </div>



    <div class="form-horizontal">
        @*<h4>Crear Requerimiento de Compra</h4>
        <hr />*@
        @Html.ValidationSummary(true)

        @*<div class="form-group">
                <div class="col-md-offset-2 col-md-10">
                    <input type="submit" value="Create" class="btn btn-default" id="BtnGuardar" />

                </div>
            </div>*@


        <div class="row">
            <div class="col-xs-12">
                @*<input value="Guardar!" class="btn btn-primary" id="BtnGuardar" />*@
                <button class="ladda-button ladda-button-demo btn btn-primary btn-lg" id="BtnGuardar"><i class="fa fa-save"></i> Guardar!</button>

            </div>
        </div>





        <div class="ibox float-e-margins">
            <div class="ibox-title">
                <h5>Cabecera</h5>
                <div class="ibox-tools">
                    <a class="collapse-link">
                        <i class="fa fa-chevron-up"></i>
                    </a>
                </div>
            </div>
            <div class="ibox-content">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="form-group">
                            @*<label class="font-noraml col-sm-2 control-label">Obra</label>*@
                            <label class="control-label" for="order_id">Obra</label>
                            <select data-placeholder="Elija la Obra..." class="chosen-select" style="width:250px;" tabindex="1" id="obra">
                                <option value="">Seleccione</option>

                                @foreach (var item in Model.Obras)
{

    if (item.id == Model.Requerimientos[0].obraId)
    {
        <option selected value=@Html.DisplayFor(modelItem => item.id)>
            @Html.DisplayFor(modelItem => item.nombre)
        </option>
    }
    else
    {
                                    <option value=@Html.DisplayFor(modelItem => item.id)>
                                        @Html.DisplayFor(modelItem => item.nombre)
                                    </option>                                         
                                    }
                                }
                            </select>

           


                        </div>
                    </div>
                    @*<div class="col-sm-4">
                        <div class="form-group">
                            <label class="control-label" for="order_id">Partida</label>
                            <select data-placeholder="Elija la Partida..." class="chosen-select" style="width:250px;" tabindex="2" id="partida">
                                <option value="">Seleccione</option>
                                @foreach (var item in Model.Partidas)
                                {
                                    <option value=@Html.DisplayFor(modelItem => item.partidaId)>
                                        @Html.DisplayFor(modelItem => item.nombre)
                                    </option>
                                }
                            </select>

                        </div>
                        </div>*@

                    <div class="col-sm-6">
                        <div class="form-group">
                            <label class="control-label" for="order_id">Prioridad</label>
                            @*<label class="font-noraml col-sm-2 control-label">Prioridad</label>*@
                            <select data-placeholder="Seleccione la Prioridad..." class="chosen-select" style="width:250px;" tabindex="3" id="prioridad">
                                <option value="">Seleccione</option>

                                @foreach (var item in Model.Prioridades)
                                {

                                    
                                    if (item.prioridadId == Model.Requerimientos[0].prioridadId)
                                    { 
                                    <option selected value=@Html.DisplayFor(modelItem => item.prioridadId)>
                                        @Html.DisplayFor(modelItem => item.nombre)
                                    </option>
                                    }
                                    else
                                    {
                                    <option value=@Html.DisplayFor(modelItem => item.prioridadId)>
                                        @Html.DisplayFor(modelItem => item.nombre)
                                    </option>                                        
                                    }                                    
                                }

                            </select>



                        </div>
                    </div>


                    <div class="col-sm-12">
                        <div class="form-group">
                            <label class="control-label" for="order_id">Comentario</label>
                            @*<label class="font-noraml col-sm-2 control-label">Comentario</label>*@
                            @*<div class="col-sm-10">*@
                            <input type="text" class="form-control" tabindex="3" id="comentario" value="@Html.DisplayFor(model => model.Requerimientos[0].comentario)"> <span class="help-block m-b-none">Agregue algún comentario a considerar durante la Orden de Compra</span>
                             @*</div>*@
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="wrapper wrapper-content animated fadeInRight">
            <div class="row">
                <div class="col-lg-12">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <h5>Elija sus Materiales haciendo click en cada material de la Tabla. Use el Filtro de Búsqueda</h5>
                            <div class="ibox-tools">
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>

                            </div>
                        </div>
                        <div class="ibox-content">

                            <table class="table table-striped table-bordered table-hover dataTables-example" id="tableMaterial">
                                <thead>
                                    <tr>
                                        <th>Id</th>
                                        <th>Código</th>
                                        <th>Material</th>
                                        <th>Unidad de Medida</th>
                                    </tr>
                                </thead>
                                <tbody>

                                    @foreach (var item in Model.Materiales)
                                    {

                                        <tr class="gradeX">
                                            <td>@Html.DisplayFor(modelItem => item.materialId)</td>
                                            <td>@Html.DisplayFor(modelItem => item.codigo)</td>
                                            <td>@Html.DisplayFor(modelItem => item.nombre)</td>
                                            <td>@Html.DisplayFor(modelItem => item.UnidadMedida.nombre)</td>
                                        </tr>
                                    }



                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th>Id</th>
                                        <th>Código</th>
                                        <th>Material</th>
                                        <th>Unidad de Medida</th>

                                    </tr>
                                </tfoot>
                            </table>

                        </div>
                    </div>
                </div>
            </div>

        </div>


        @*<div class="row">
                <div class="col-lg-12">
                    <div class="ibox float-e-margins">
                        <div class="ibox-title">
                            <h5>Materiales Seleccionados</h5>
                            <div class="ibox-tools">
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>

                            </div>
                        </div>
                        <div class="ibox-content">

                            <table class="table table-striped table-bordered table-hover dataTables-example" id="editableMaterial">
                                <thead>
                                    <tr>
                                        <th>Id</th>
                                        <th>Código</th>
                                        <th>Material</th>
                                        <th>Unidad de Medida</th>
                                        <th>Cantidad</th>
                                        <th></th>
                                    </tr>
                                </thead>
                                <tbody>


                                </tbody>
                                <tfoot>
                                    <tr>
                                        <th>Id</th>
                                        <th>Código</th>
                                        <th>Material</th>
                                        <th>Unidad de Medida</th>
                                        <th>Cantidad</th>
                                        <th></th>
                                    </tr>

                                </tfoot>
                            </table>

                        </div>
                    </div>
                </div>
            </div>*@



        <div class="wrapper wrapper-content  animated fadeInRight">
            <div class="row">
                <div class="col-sm-8">
                    <div class="ibox">
                        <div class="ibox-content">
                            @*<span class="text-muted small pull-right">Last modification: <i class="fa fa-clock-o"></i> 2:10 pm - 12.06.2014</span>
                                <h2>Clients</h2>
                                <p>
                                    All clients need to be verified before you can send email and set a project.
                                </p>
                                <div class="input-group">
                                    <input type="text" placeholder="Search client " class="input form-control">
                                    <span class="input-group-btn">
                                        <button type="button" class="btn btn btn-primary"> <i class="fa fa-search"></i> Search</button>
                                    </span>
                                </div>*@
                            <div class="clients-list">
                                <ul class="nav nav-tabs">
                                    @*<span class="pull-right small text-muted">1406 Elements</span>*@
                                    <li class="active"><a data-toggle="tab" href="#tab-1"><i class="fa fa-user"></i> Materiales Agregados</a></li>
                                    @*<li class=""><a data-toggle="tab" href="#tab-2"><i class="fa fa-briefcase"></i> Companies</a></li>*@
                                </ul>
                                <div class="tab-content">
                                    <div id="tab-1" class="tab-pane active">
                                        <div class="full-height-scroll">
                                            <div class="table-responsive">
                                                <table id="editableMaterial2" class="table table-striped table-hover">
                                                    @foreach (var item in Model.Requerimientos[0].Detalles)
                                                    {

                                                        <tr class="gradeX">
                                                            <td>@Html.DisplayFor(modelItem => item.Material.materialId)</td>
                                                            <td>@Html.DisplayFor(modelItem => item.Material.nombre)</td>
                                                            <td>@Html.DisplayFor(modelItem => item.Material.UnidadMedida.nombre)</td>
                                                            <td>@Html.DisplayFor(modelItem => item.cantidad)</td>
                                                            <td>@Html.DisplayFor(modelItem => item.Partida.partidaId)</td>
                                                            @*<td>@Html.DisplayFor(modelItem => item.Partida.nombre)</td>*@
                                                            <td>@Html.DisplayFor(modelItem => item.Partida.nombre) - @Html.DisplayFor(modelItem => item.Partida.SubPresupuesto.nombre)</td>
                                                            <td><button type="button" class="btn btn-danger btn-sm btn-block" id="btnEliminar"> Eliminar!!</button></td>
                                                        </tr>
                                                    }

                                                </table>
                                            </div>
                                        </div>
                                    </div>

                                </div>

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-sm-4">
                    <div class="ibox ">

                        <div class="ibox-content">
                            <div class="tab-content">
                                @*<div id="contact-1" class="tab-pane active">*@
                                <div id="contact-1" class="tab-pane active">

                                    <div class="row m-b-lg">
                                        @*<div class="col-lg-4 text-center">
                                                <h2><label class="control-label"> Material</label></h2>

                                                <div class="m-b-sm">
                                                    <img alt="image" class="img-circle" src="~/Images/a2.jpg"
                                                         style="width: 62px">
                                                </div>
                                            </div>*@
                                        <div class="col-lg-12">
                                            <strong>
                                                <label id="lblIdMaterial"></label>
                                                <h2><label class="control-label" id="lblMaterial">Seleccione Material</label></h2>
                                            </strong>

                                            @*<p>
                                                   Ingrese la cantidad de Material a Solicitar y Seleccione a la Partida de Control
                                                    que pertenece.
                                                </p>*@

                                        </div>
                                    </div>
                                    <div class="client-detail">
                                        <div class="full-height-scroll">

                                            <strong>Ingresar Información</strong>

                                            <ul class="list-group clear-list">

                                                <li class="list-group-item fist-item">
                                                    <label class="control-label" for="order_id">Cantidad</label>
                                                    <input type="text" id="txtcantidad" class="form-control" style="width:250px;">
                                                    <label class="control-label" id="lblUnidadMedida"> </label>
                                                </li>
                                                <li class="list-group-item fist-item">

                                                    <label class="control-label" for="order_id">Partida</label>
                                                    @*<select id="partidaid">*@
                                                    @*<select data-placeholder="Elija la Partida..." class="chosen-select" style="width:250px;" id="partidaid">*@
                                                    <select data-placeholder="Elija la Partida..." style="width:250px;" id="partidaid">
                                                        <option value="">Seleccione</option>
                                                        @foreach (var item in Model.Partidas)
                                                        {
                                                            <option value=@Html.DisplayFor(modelItem => item.partidaId)>
                                                                @Html.DisplayFor(modelItem => item.nombre) - @Html.DisplayFor(modelItem => item.SubPresupuesto.nombre)
                                                            </option>
                                                        }
                                                    </select>



                                                </li>



                                            </ul>
                                            <strong>Nota</strong>
                                            <p>
                                                Luego de ingresado las cantidades y las partidas, agregue los valores de los materiales haciendo click en Agregar!
                                            </p>
                                            <hr />
                                            <button type="button" class="btn btn-primary btn-sm btn-block" id="btnAgregarItem">
                                                <i class="fa fa-save"></i> Agregar!
                                            </button>

                                        </div>


                                    </div>
                                </div>
                               
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



    </div>

}


<div>
    @Html.ActionLink("Back to List", "Index")
</div>




@section Styles {

    @Styles.Render("~/plugins/awesomeCheckboxStyles")
    @Styles.Render("~/plugins/clockpickerStyles")
    @Styles.Render("~/plugins/dateRangeStyles")
    @Styles.Render("~/Content/plugins/iCheck/iCheckStyles")
    @Styles.Render("~/Content/plugins/chosen/chosenStyles")
    @Styles.Render("~/plugins/switcheryStyles")
    @Styles.Render("~/plugins/jasnyBootstrapStyles")
    @Styles.Render("~/plugins/nouiSliderStyles")
    @Styles.Render("~/plugins/dataPickerStyles")
    @Styles.Render("~/Content/plugins/ionRangeSlider/ionRangeStyles")
    @Styles.Render("~/plugins/imagecropperStyles")
    @Styles.Render("~/Content/plugins/colorpicker/colorpickerStyles")
    @Styles.Render("~/plugins/select2Styles")
    @Styles.Render("~/plugins/touchSpinStyles")
    @Styles.Render("~/Content/plugins/dataTables/dataTablesStyles")
@Styles.Render("~/plugins/laddaStyles")
}

@section Scripts {
    @Scripts.Render("~/plugins/iCheck")
    @Scripts.Render("~/plugins/dataPicker")
    @Scripts.Render("~/plugins/ionRange")
    @Scripts.Render("~/plugins/nouiSlider")
    @Scripts.Render("~/plugins/jasnyBootstrap")
    @Scripts.Render("~/plugins/switchery")
    @Scripts.Render("~/plugins/chosen")
    @Scripts.Render("~/plugins/knob")
    @Scripts.Render("~/plugins/imagecropper")
    @Scripts.Render("~/plugins/colorpicker")
    @Scripts.Render("~/plugins/clockpicker")
    @Scripts.Render("~/plugins/dateRange")
    @Scripts.Render("~/plugins/select2")
    @Scripts.Render("~/plugins/touchSpin")
    @Scripts.Render("~/plugins/dataTables")
    @Scripts.Render("~/plugins/jeditable")
@Scripts.Render("~/plugins/ladda")

    <script type="text/javascript">
        $(document).ready(function () {


            $("#lblIdMaterial").css('visibility', 'hidden');




            // Manejo Tables

            $('.dataTables-example').DataTable({
                dom: '<"html5buttons"B>lTfgitp',
                buttons: [
                    { extend: 'copy' },
                    { extend: 'csv' },
                    { extend: 'excel', title: 'ExampleFile' },
                    { extend: 'pdf', title: 'ExampleFile' },

                    {
                        extend: 'print',
                        customize: function (win) {
                            $(win.document.body).addClass('white-bg');
                            $(win.document.body).css('font-size', '10px');

                            $(win.document.body).find('table')
                                    .addClass('compact')
                                    .css('font-size', 'inherit');
                        }
                    }
                ]

            });

            /* Init DataTables */
            var oTable = $('#editable').dataTable();

            /* Apply the jEditable handlers to the table */
            oTable.$('td').editable('../example_ajax.php', {
                "callback": function (sValue, y) {
                    var aPos = oTable.fnGetPosition(this);
                    oTable.fnUpdate(sValue, aPos[0], aPos[1]);
                },
                "submitdata": function (value, settings) {
                    return {
                        "row_id": this.parentNode.getAttribute('id'),
                        "column": oTable.fnGetPosition(this)[2]
                    };
                },

                "width": "90%",
                "height": "100%"
            });

            // Fin Manejo Tables






            // Función que copia contenido de fila seleccionada y copia en tabla destino
            var table = $('#tableMaterial').DataTable();

            $('#tableMaterial tbody').on('click', 'tr', function () {
                if ($(this).hasClass('selected')) {
                    $(this).removeClass('selected');
                }
                else {
                    table.$('tr.selected').removeClass('selected');
                    $(this).addClass('selected');
                }

                var row = $(this),
                cloneRow = row.clone();

                cloneRow.append('<td><input type="text" class="form-control" id="cantidad"></td>').append('<td><button type="button" class="btn btn-danger btn-sm btn-block" id="btnEliminar"> Eliminar!!</button></td>');
                //          cloneRow.append('<td><input type="text" class="form-control" id="cantidad"></td>').append('<td><button type="button" class="btn btn-danger btn-sm btn-block" id="btnEliminar"> Eliminar!!</button></td>').append($('#partida').clone().show());
                //cloneRow.append();

                copyTable = $('#editableMaterial tbody');

                //copyTable.append(cloneRow);

                var table3 = $('#editableMaterial').DataTable();
                //table3.row.add([1, 2, 3, 4]).draw();
                table3.row.add(cloneRow).draw();
                //table.row('.selected').remove().draw(false);

                // Nueva Tabla de Materiales seleccionados
                cloneRow2 = row.clone();
                //cloneRow2.append('<td><button type="button" class="btn btn-danger btn-sm btn-block" id="btnEliminar2"> Eliminar!!</button></td>').append('<td><a data-toggle="tab" href="#contact-1" class="client-link">Cantidad</a></td>')
                var codigo = cloneRow2.find("td:eq(0)").html();
                var nombre = cloneRow2.find("td:eq(2)").html();
                var unidadmedida = cloneRow2.find("td:eq(3)").html();

                $("#editableMaterial2").append('<tr><td>' + codigo + '</td><td>' + nombre + '</td><td>' + unidadmedida + '</td><td><span class="label label-warning">falta cantidad</span></td><td></td><td><span class="label label-warning">falta partida</span></td><td><button type="button" class="btn btn-danger btn-sm btn-block" id="btnEliminar2"> Eliminar!!</button></td></tr>');


                ////Create Edit Panel

                //var $div = $('#contact-1');
                //var $klon = $div.clone().prop('id', 'contact-'+codigo);

                //$klon.find('#partidaid').attr("id", "partida-"+ codigo);
                //$div.after($klon);




            });
            //Fin funcion



            // Función que elimina fila de Tabla Materiales Seleccionados
            var table2 = $('#editableMaterial').DataTable();

            $('#editableMaterial tbody').on('click', 'button', function () {



                //if ($(this).hasClass('selected')) {
                //    $(this).removeClass('selected');
                //}
                //else {
                //    table2.$('tr.selected').removeClass('selected');
                //    $(this).addClass('selected');
                //}
                //var row = $(this);

                table2
                        .row($(this).parents('tr'))
                        .remove()
                        .draw();

                //alert(row);
                //Pendiente
                //table2.row(row).remove().draw(false);

            });




            var table3 = $('#editableMaterial2');


            $('#editableMaterial2').on('click', 'button', function () {

                $(this).parents('tr').remove();

            });


            // Fin Función que elimina fila de Tabla Materiales Seleccionados


            $('#editableMaterial2').on('click', 'tr', function () {


                var texto = $(this).find("td:eq(1)").html();
                var idMaterial = $(this).find("td:eq(0)").html();
                var idUnidadMedida = $(this).find("td:eq(2)").html();
                var cantidad = $(this).find("td:eq(3)").html();
                var partidacodigo = $(this).find("td:eq(4)").html();

                if (cantidad.length > 5 && partidacodigo.length == 0) {
                    $('#lblMaterial').text(texto);
                    $('#lblIdMaterial').text(idMaterial);
                    $('#lblUnidadMedida').text(idUnidadMedida);
                    $('#txtcantidad').val("");
                }
                else {
                    //alert(partidacodigo);
                    $('#lblMaterial').text(texto);
                    $('#lblIdMaterial').text(idMaterial);
                    $('#lblUnidadMedida').text(idUnidadMedida);
                    $('#txtcantidad').val(cantidad);

                    //$('#partidaid option[value="' + partidacodigo + '"]').attr('selected', true);
                    //$('#partidaid option[value=""]').attr('selected', true);
                    // $('#partidaid :selected').attr('selected', false);

                    //$("#partidaid option:selected").text("DERRAMES");


                    //               $("#partidaid").val(partidacodigo);
                    // $("#partidaid option[value='2']").attr('selected', true);
                    //$("#partidaid option[value='2']").attr("selected", "selected");


                    //$('#partidaid').removeAttr('selected');
                    //               $('#partidaid option[value="' + partidacodigo + '"]').attr('selected', true).change();

                    //$("#partidaid").val("' + partidacodigo + '").change();
                    //alert($('#partidaid').find('option[value=' + partidacodigo + ']'));
                    //$('#partidaid').find('option[value=' + partidacodigo + ']').prop('selected', true).trigger('change');

                    //class="chosen-select"
                    //$('#partidaid').removeClass('chosen-select');
                    $('#partidaid').val(partidacodigo);

                }

            });


            $("#btnAgregarItem").click(function () {

                var idmaterial = $('#lblIdMaterial').text();
                var cantidad = $('#txtcantidad').val();
                var partidacodigo = $("#partidaid").val();
                var partidatexto = $("#partidaid option:selected").text();


                if (idmaterial == "") {
                    alert("No ha seleccionado Material");
                    return;
                }

                if (cantidad == "") {
                    alert("Ingrese cantidad");
                    return;
                }
                if (partidacodigo == "") {
                    alert("Seleccione la Partida");
                    return;
                }

                $('#editableMaterial2 tr').each(function () {


                    if ($(this).find("td").eq(0).html() == $('#lblIdMaterial').text()) {

                        // alert($("#partidaid option:selected").text());


                        $(this).find("td").eq(3).text(cantidad);
                        $(this).find("td").eq(4).text(partidacodigo);
                        $(this).find("td").eq(5).text(partidatexto);
                    }

                });


                $('#lblIdMaterial').text("");
                $('#lblMaterial').text("");
                $('#lblUnidadMedida').text("");
                $('#txtcantidad').val("");





            });




            // Función que guarda datos de Tabla Materiales Seleccionados


            $("#BtnGuardar").click(function () {

                var cells = [];
                var rows = $("#editableMaterial").dataTable().fnGetNodes();

                //for (var i = 0; i < rows.length; i++) {
                //    // Get HTML of 3rd column (for example)
                //    //cells.push($(rows[i]).find("td:eq(4)").html());

                //    //cells.push($(rows[i]).find("td:eq(4) input[type='text']").val());

                //    cells.push({
                //        cantidad: $(rows[i]).find("td:eq(4) input[type='text']").val(),
                //        materialid: $(rows[i]).find("td:eq(0)").html()
                //    });
                //}

                $('#editableMaterial2 tr').each(function () {

                    cells.push({
                        cantidad: $(this).find("td").eq(3).html(),
                        materialid: $(this).find("td").eq(0).html(),
                        partidaId: $(this).find("td").eq(4).html()
                        //$(this).find("td").eq(3).text(cantidad);
                        //$(this).find("td").eq(4).text(partidacodigo);
                        //$(this).find("td").eq(5).text(partidatexto);

                    });
                });

                //alert(cells);

                //var data = $.parseJSON(cells);
                var Detalles = [];

                for (var i = 0; i < cells.length; i++) {
                    var requerimientoDetalle = new Object();

                    requerimientoDetalle.materialId = cells[i].materialid;
                    requerimientoDetalle.cantidad = cells[i].cantidad;
                    requerimientoDetalle.partidaId = cells[i].partidaId;
                    requerimientoDetalle.estadoRequerimientoDetalleId = 1;
                    Detalles.push(requerimientoDetalle);

                }


                var requerimiento = new Object();
                requerimiento.requerimientoId = $("#Requerimientos_0__requerimientoId").val();
                requerimiento.obraId = $("#obra").val();
                requerimiento.prioridadId = $("#prioridad").val();
                requerimiento.comentario = $("#comentario").val();
                requerimiento.tipoCompraId = $("#TipoCompra_tipoCompraId").val();
                requerimiento.usuarioCreacion = "aa";

                requerimiento.Detalles = Detalles;

                var requerimientoViewModel = new Object();

                //requerimientoViewModel.Requerimiento = requerimiento

                RequerimientoFinal = JSON.stringify({ 'requerimiento': requerimiento });

                //alert(RequerimientoFinal);


                $.ajax({
                    contentType: 'application/json; charset=utf-8',
                    //dataType: 'json', // Tells the server what kind of content the client is expecting back as the result.
                    type: 'POST',
                    //          param: RequerimientoFinal,
                    url: '@Url.Action("EditarRequerimiento")',
                    data: RequerimientoFinal,
                    success: function (data) {
                        //alert('success');
                        window.location = '@Url.Action("Index/" + @Html.DisplayFor(model => model.TipoCompra.tipoCompraId))';
                    },
                    error: function (result) {
                        //window.location = Url.Action("Index/" + Html.DisplayFor(model => model.TipoCompra.tipoCompraId))';
                        alert('No se pudo insertar. Revise que toda la información esté seleccionada');
                        $('.ladda-button-demo').ladda().ladda('stop');
                        //alert(result.statusText);
                        //alert("hola");
                    }
                });
                //.done(function (result) {
                //    //alert("pasó");
                //});
            });



            //Procesar botón hasta que termine el proceso
            var l = $('.ladda-button-demo').ladda();
            l.click(function () {
                // Start loading
                l.ladda('start');
                // Do something in backend and then stop ladda
                // setTimeout() is only for demo purpose

                context: $(this)
                //l.ladda('stop');
            });


        });




        var config = {
            '.chosen-select': {},
            '.chosen-select-deselect': { allow_single_deselect: true },
            '.chosen-select-no-single': { disable_search_threshold: 10 },
            '.chosen-select-no-results': { no_results_text: 'Oops, nothing found!' },
            '.chosen-select-width': { width: "95%" }
        }
        for (var selector in config) {
            $(selector).chosen(config[selector]);
        }

        $("#ionrange_1").ionRangeSlider({
            min: 0,
            max: 5000,
            type: 'double',
            prefix: "$",
            maxPostfix: "+",
            prettify: false,
            hasGrid: true
        });

        $("#ionrange_2").ionRangeSlider({
            min: 0,
            max: 10,
            type: 'single',
            step: 0.1,
            postfix: " carats",
            prettify: false,
            hasGrid: true
        });

        $("#ionrange_3").ionRangeSlider({
            min: -50,
            max: 50,
            from: 0,
            postfix: "°",
            prettify: false,
            hasGrid: true
        });

        $("#ionrange_4").ionRangeSlider({
            values: [
                "January", "February", "March",
                "April", "May", "June",
                "July", "August", "September",
                "October", "November", "December"
            ],
            type: 'single',
            hasGrid: true
        });

        $("#ionrange_5").ionRangeSlider({
            min: 10000,
            max: 100000,
            step: 100,
            postfix: " km",
            from: 55000,
            hideMinMax: true,
            hideFromTo: false
        });

        $(".dial").knob();








    </script>
}